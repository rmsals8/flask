{% extends "base.html" %}
{% block content %}
<div class="container mx-auto p-4">
    <h1 class="text-2xl font-bold mb-4">챗봇 테스트</h1>
    <div id="chat-box" class="bg-gray-100 p-4 h-64 overflow-y-auto mb-4"></div>
    <form id="chat-form" class="flex">
        <input type="text" id="user-input" class="flex-grow p-2 border rounded-l" placeholder="메시지를 입력하세요...">
        <button type="submit" class="bg-blue-500 text-white p-2 rounded-r">전송</button>
    </form>
</div>

<script>
document.getElementById('chat-form').addEventListener('submit', function(e) {
    e.preventDefault();
    var userInput = document.getElementById('user-input');
    var chatBox = document.getElementById('chat-box');
    
    // 사용자 메시지 표시
    chatBox.innerHTML += '<p class="mb-2"><strong>나:</strong> ' + userInput.value + '</p>';
    
    // 서버에 메시지 전송
    fetch('/chat', {
        method: 'POST',
        headers: {
            'Content-Type': 'application/x-www-form-urlencoded',
        },
        body: 'message=' + encodeURIComponent(userInput.value)
    })
    .then(response => response.json())
    .then(data => {
        // 봇 응답 표시
        chatBox.innerHTML += '<p class="mb-2"><strong>봇:</strong> ' + data.response + '</p>';
        chatBox.scrollTop = chatBox.scrollHeight;
    });
    
    userInput.value = '';
});
</script>
{% endblock %}